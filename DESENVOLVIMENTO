Cria uma nova BOM da montagem principal.
A BOM da submontagem é analisada como um "componente", não como uma sequência de itens já ordenados.
Quando você expande a BOM estruturada da montagem principal, o Inventor reordena os filhos automaticamente, geralmente em ordem alfabética ou conforme o padrão de inserção.
Resultado: a ordem anterior é ignorada.
Percorrer cada submontagem recursivamente (bottom-up).
Em cada uma, acessar sua BOM estruturada e registrar os números de item atuais.
Armazenar esse mapeamento: FullFileName → {DocPart → ItemNumber}.
Ao retornar para a montagem pai, usar esse dicionário para reaplicar os mesmos números de item às referências da submontagem.
Use um Dictionary(Of String, Dictionary(Of String, String)) para guardar os números por submontagem.
Vá do fundo para o topo (sub para pai).
Use ComponentDefinition.BOM.BOMViews("Structured") para acessar a BOM de cada submontagem.
Use .ItemNumber para ler e reaplicar os valores.
